<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
        >

    <ui:composition template="WEB-INF/DefaultTemplate.xhtml">

        <ui:param name="active" value="Restaurants" />
        <ui:param name="title" value="Restaurant anlegen" />

        <ui:define name="titleHeader">
            <h2>#{title}</h2>
        </ui:define>

        <ui:define name="mainContent">

            <h:form var="w">

                <h:inputHidden value="#{backingBeanRestaurant.current.id}" />

                <div class="form-group">
                    <label for="name">Name:<h:message for="name" class="text-danger" /></label>
                    <h:inputText id="name" value="#{backingBeanRestaurant.current.name}" class="form-control" required="false" requiredMessage="Erforderlich!">
                        <!-- <f:validator validatorId="customValidator" />-->
                    </h:inputText>
                </div>

                <div class="form-group">
                    <label for="email">E-Mail:<h:message for="email" class="text-danger" /></label>
                    <h:inputText id="email" value="#{backingBeanRestaurant.current.email}" class="form-control" required="false" requiredMessage="Erforderlich!">
                        <!-- <f:validator validatorId="customValidator" />-->
                    </h:inputText>
                </div>

                <div class="form-group">
                    <label for="phoneNumber">Telefon:<h:message for="phoneNumber" class="text-danger" /></label>
                    <h:inputText id="phoneNumber" value="#{backingBeanRestaurant.current.phoneNumber}" class="form-control" required="false" requiredMessage="Erforderlich!">
                        <!-- <f:validator validatorId="customValidator" />-->
                    </h:inputText>
                </div>
    <!--Adresse-->
                <div class="form-group">
                    <label for="street">Straße und Hausnummer<h:message for="street" class="text-danger" /></label>
                    <h:inputText id="street" value="#{backingBeanRestaurant.current.addressRestaurant.street}" class="form-control" required="false" requiredMessage="Erforderlich!">
                        <!-- <f:validator validatorId="customValidator" />-->
                    </h:inputText>

                    <h:inputText id="houseNumber" value="#{backingBeanRestaurant.current.addressRestaurant.houseNumber}" class="form-control" required="false" requiredMessage="Erforderlich!">
                        <!-- <f:validator validatorId="customValidator" />-->
                    </h:inputText>
                </div>

                <div class="form-group">
                    <label for="zipCode">PLZ und Ort:<h:message for="zipCode" class="text-danger" /></label>
                    <h:inputText id="zipCode" value="#{backingBeanRestaurant.current.addressRestaurant.zipCode}" class="form-control" required="false" requiredMessage="Erforderlich!">
                        <!-- <f:validator validatorId="customValidator" />-->
                    </h:inputText>

                    <h:inputText id="city" value="#{backingBeanRestaurant.current.addressRestaurant.city}" class="form-control" required="false" requiredMessage="Erforderlich!">
                        <!-- <f:validator validatorId="customValidator" />-->
                    </h:inputText>
                </div>

<!--Position-->
                <p:growl id="growlLocation" showDetail="true"  />
                <p:panel>
                    <div class="form-group">
                        <label for="wgs84Lat">Position auf Breiten- und Längengrad:
                            <h:commandLink id="linkGrabPos" >jetzt ermitteln!</h:commandLink></label>

                        <div class="row">
                            <div class="col-6">
                                <p:inputText id="wgs84Lat" value="#{backingBeanRestaurant.validateLat}" class="form-control" validator="#{serverValidatorWGS.validate}" >
                                    <p:clientValidator/>
                                    <f:validateRegex pattern="^((?!((,|\.)(.*)(,|\.))|((\+|\-)(.*)(\+|\-))|([a-z])|(([0-9,\.]\+)|([0-9,\.]\-)|((\+|\-)$)|(.\s.))).)*$"/>
                                </p:inputText>

                            </div>
                            <div class="col-6">
                                <p:inputText id="wgs84Lon" value="#{backingBeanRestaurant.validateLon}" class="form-control" validator="#{serverValidatorWGS.validate}" >
                                    <p:clientValidator/>
                                    <f:validateRegex pattern="^((?!((,|\.)(.*)(,|\.))|((\+|\-)(.*)(\+|\-))|([a-z])|(([0-9,\.]\+)|([0-9,\.]\-)|((\+|\-)$)|(.\s.))).)*$"/>
                                </p:inputText>
                            </div>
                            <p:commandButton validateClient="true" ajax="false" rendered="#{false}" update="@form"/>
                        </div>
                    </div>
                </p:panel>
                <br/>


<!--Links            -->
                <div class="form-group">
                    <label for="linkMenu">Link zur Speisekarte: <h:message for="linkMenu" class="text-danger" />
                        <h:outputLink value="#{backingBeanRestaurant.current.linkMenu}" target="_blank">URL in neuem Tab</h:outputLink>
                    </label>

                    <h:inputText id="linkMenu" value="#{backingBeanRestaurant.current.linkMenu}" class="form-control" required="false">
                        <f:converter converterId="urlStringConverter" />

                        <ui:remove> <!--<f:converter converterId = "urlConverter" />--> </ui:remove>
                    </h:inputText>
                </div>


<!--Culinaries            -->
                <!-- equals, hashcode und toString müssen implementiert sein https://stackoverflow.com/questions/17343032/implement-converters-for-entities-with-java-generics/17343582#17343582-->
                <div>
                    <h:selectOneMenu value="#{backingBeanRestaurant.current.culinary}" select2="true" styleClass="form-control"  converter="omnifaces.SelectItemsConverter">
                        <f:selectItem itemLabel="Gebotene Küche" itemValue="" />
                        <f:selectItems value="#{backingBeanRestaurant.getAllCulinaries()}" var="culi" itemValue="#{culi}" itemLabel="#{culi.getCategory()}"/>
                    </h:selectOneMenu>
                </div>


<!--Buttons-->
                <hr/>
                <h:commandButton action="#{backingBeanRestaurant.saveRestaurant()}" value="Speichern" class="btn btn-success" />
                <h:commandButton action="#{backingBeanRestaurant.createNew()}" value="Restaurant anlegen" class="btn btn-primary" />
                <h:commandButton action="#{backingBeanRestaurant.createNew()}" value="#Restaurantbesuch planen" class="btn btn-warning" />
            </h:form>
        </ui:define>

        <ui:define name="subContent">
            <h1>sub</h1>
        </ui:define>

        <ui:define name="footer">
        </ui:define>


    </ui:composition>
</html>